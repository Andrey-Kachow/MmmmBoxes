#!/usr/bin/env bash

# Create and activate virtual environment
python3 -m venv venv
source venv/bin/activate

# Install reqs
pip install --upgrade pip && pip install -r requirements.txt

export FLASK_APP=app/flaskr
export FLASK_ENV=development
export FLASK_DEBUG=1

# If "$PORT" is undefined, then call runme with no args, running locally.
# Otherwise, run it with the appropriate args.
if [ -z "$PORT" ]
then
    echo "Running flask locally!"
    python3 runme.py local
else
    echo "Running flask in Heroku!"
    if [ "$#" -ne 1 ]
    then
        echo "Argument has been passed in. Assuming we are running dev build."
        python3 runme.py dev 0.0.0.0 $PORT
    else
        python3 runme.py live 0.0.0.0 $PORT
    fi
fi
